<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Interactive Nidānas: The Wheel of Dependent Origination</title>
  <style>
    /* ===== BASE STYLES ===== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    :root {
      --bg-primary: #0a0a12;
      --bg-secondary: #12121e;
      --bg-tertiary: #1a1a2e;
      --text-primary: rgba(230, 230, 240, 0.96);
      --text-secondary: rgba(200, 200, 220, 0.85);
      --text-tertiary: rgba(170, 170, 190, 0.75);
      
      --accent-blue: rgba(100, 150, 255, 0.9);
      --accent-cyan: rgba(120, 210, 255, 0.9);
      --accent-gold: rgba(255, 200, 120, 0.9);
      --accent-mint: rgba(150, 255, 180, 0.9);
      --accent-purple: rgba(180, 120, 255, 0.9);
      
      --glow-blue: rgba(80, 120, 255, 0.4);
      --glow-cyan: rgba(100, 200, 255, 0.4);
      --glow-gold: rgba(255, 200, 100, 0.4);
      --glow-mint: rgba(100, 255, 180, 0.4);
      --glow-purple: rgba(150, 100, 255, 0.4);
      
      --transition-smooth: cubic-bezier(0.22, 1, 0.36, 1);
      --transition-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
      --font-sans: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      --font-mono: "Menlo", "Monaco", "Consolas", monospace;
      --font-pali: "Arial Unicode MS", "Tahoma", serif;
    }
    
    body {
      background: var(--bg-primary);
      color: var(--text-primary);
      font-family: var(--font-mono);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow-x: hidden;
      perspective: 1px;
    }
    
    /* ===== MOBILE CONTAINER ===== */
    .mobile-container {
      width: 390px;
      height: 844px;
      background: linear-gradient(135deg, var(--bg-primary), var(--bg-tertiary));
      border-radius: 40px;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5),
                 inset 0 0 2px rgba(255, 255, 255, 0.05);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      position: relative;
    }
    
    /* ===== CONTENT AREA ===== */
    .content-area {
      flex: 1;
      overflow-y: auto;
      perspective: 1200px;
      overflow-x: hidden;
      scroll-behavior: smooth;
      position: relative;
      scrollbar-width: thin;
      scrollbar-color: var(--accent-cyan) rgba(255, 255, 255, 0.05);
      scroll-snap-type: y proximity;
    }
    
    .content-area::-webkit-scrollbar {
      width: 6px;
    }
    
    .content-area::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
    }
    
    .content-area::-webkit-scrollbar-thumb {
      background: var(--accent-cyan);
      border-radius: 3px;
    }
    
    /* ===== SPLASH SCREEN ===== */
    .splash-screen {
      position: absolute;
      inset: 0;
      background: rgba(10, 10, 18, 0.95);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 100;
      opacity: 1;
      transition: opacity 0.8s var(--transition-smooth),
                  transform 0.8s var(--transition-smooth);
      text-align: center;
      pointer-events: none;
    }
    
    .splash-title {
      color: var(--accent-cyan);
      font-size: 2rem;
      text-shadow: 0 0 10px var(--glow-cyan);
      margin-bottom: 1rem;
      transform: translateY(0);
      transition: transform 1s var(--transition-smooth);
    }
    
    .splash-subtitle {
      color: var(--text-secondary);
      font-size: 0.9rem;
      opacity: 0.8;
      transform: translateY(0);
      transition: transform 1s var(--transition-smooth);
    }
    
    .splash-screen.hide {
      opacity: 0;
      transform: translateY(-20px);
    }
    
    .splash-screen.hide .splash-title {
      transform: translateY(-20px);
    }
    
    .splash-screen.hide .splash-subtitle {
      transform: translateY(20px);
    }
    
    /* ===== SECTION STYLES ===== */
    .section {
      padding: 2rem 1.5rem;
      margin-bottom: 1rem;
      scroll-snap-align: start;
      position: relative;
      transform-style: preserve-3d;
      overflow: hidden;
    }
    
    .section::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(to right, 
                 rgba(120, 210, 255, 0),
                 rgba(120, 210, 255, 0.4),
                 rgba(120, 210, 255, 0));
      opacity: 0;
      transform: translateY(-10px);
      transition: opacity 0.6s var(--transition-smooth),
                  transform 0.6s var(--transition-smooth);
    }
    
    .section.visible::before {
      opacity: 1;
      transform: translateY(0);
    }
    
    .section-title {
      color: var(--accent-cyan);
      font-size: 1.5rem;
      margin-bottom: 1rem;
      text-align: center;
      text-shadow: 0 0 8px var(--glow-cyan);
      position: relative;
      z-index: 2;
      transition: text-shadow 0.6s var(--transition-smooth);
    }
    
    .section-title:hover {
      text-shadow: 0 0 15px var(--glow-cyan);
    }
    
    .section-subtitle {
      color: var(--text-secondary);
      font-size: 0.9rem;
      text-align: center;
      margin-bottom: 2rem;
      font-style: italic;
      position: relative;
      z-index: 2;
    }
    
    .section-background {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 50% 30%, 
                  rgba(100, 200, 255, 0.08),
                  rgba(100, 200, 255, 0) 70%);
      opacity: 0;
      transition: opacity 0.8s var(--transition-smooth);
      z-index: 1;
      pointer-events: none;
    }
    
    .section.visible .section-background {
      opacity: 1;
    }
    
    /* ===== NIDANA LIST ===== */
    .nidana-list {
      list-style: none;
      margin: 0;
      padding: 0;
      position: relative;
      z-index: 2;
    }
    
    .nidana-item {
      margin-bottom: 1.5rem;
      transform-style: preserve-3d;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.6s var(--transition-smooth),
                  transform 0.6s var(--transition-smooth);
    }
    
    .nidana-item.visible {
      opacity: 1;
      transform: translateY(0);
    }
    
    /* ===== NIDANA CARD ===== */
    .nidana-card {
      background: rgba(20, 30, 50, 0.4);
      border: 1px solid rgba(100, 200, 255, 0.15);
      border-radius: 12px;
      overflow: hidden;
      position: relative;
      transition: all 0.3s var(--transition-smooth),
                  transform 0.3s var(--transition-bounce),
                  box-shadow 0.3s var(--transition-smooth);
      transform-style: preserve-3d;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      will-change: transform, box-shadow;
    }
    
    .nidana-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3),
                 0 0 8px var(--glow-cyan);
    }
    
    .nidana-card.expanded {
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3),
                 0 0 15px var(--glow-cyan);
    }
    
    .nidana-card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(45deg, 
                  rgba(100, 200, 255, 0.05),
                  rgba(100, 200, 255, 0));
      z-index: 0;
      transition: opacity 0.3s var(--transition-smooth);
    }
    
    .nidana-card:hover::before {
      opacity: 1.5;
    }
    
    .nidana-header {
      padding: 1rem;
      display: flex;
      align-items: center;
      cursor: pointer;
      position: relative;
      z-index: 2;
      transition: background-color 0.3s var(--transition-smooth);
    }
    
    .nidana-card.expanded .nidana-header {
      background-color: rgba(100, 150, 255, 0.1);
    }
    
    .nidana-number {
      font-weight: 700;
      color: var(--accent-blue);
      text-shadow: 0 0 6px var(--glow-blue);
      margin-right: 0.8rem;
      font-size: 1.2rem;
      transition: color 0.3s ease, text-shadow 0.3s ease;
      width: 1.8rem;
      text-align: center;
    }
    
    .nidana-card:hover .nidana-number {
      color: var(--accent-cyan);
      text-shadow: 0 0 10px var(--glow-cyan);
    }
    
    .nidana-term {
      font-family: var(--font-pali);
      color: var(--accent-gold);
      text-shadow: 0 0 6px var(--glow-gold);
      font-style: italic;
      margin-right: 0.8rem;
      transition: color 0.3s ease, text-shadow 0.3s ease;
      flex: 1;
    }
    
    .nidana-card:hover .nidana-term {
      text-shadow: 0 0 10px var(--glow-gold);
    }
    
    .nidana-meaning {
      color: var(--text-secondary);
      margin-left: auto;
      font-size: 0.9rem;
      text-align: right;
      transition: color 0.3s ease;
    }
    
    .nidana-card:hover .nidana-meaning {
      color: var(--text-primary);
    }
    
    .expand-icon {
      margin-left: 0.5rem;
      transition: transform 0.4s var(--transition-bounce);
      font-size: 1.2rem;
      width: 20px;
      display: flex;
      justify-content: center;
      color: var(--text-secondary);
    }
    
    .nidana-card:hover .expand-icon {
      color: var(--text-primary);
    }
    
    .nidana-card.expanded .expand-icon {
      transform: rotate(180deg);
      color: var(--accent-cyan);
    }
    
    /* ===== NIDANA CONTENT ===== */
    .nidana-content {
      height: 0;
      overflow: hidden;
      transition: height 0.4s var(--transition-smooth);
      padding: 0 1rem;
      opacity: 0;
      transform: translateY(-10px);
      transition: opacity 0.4s var(--transition-smooth),
                  transform 0.4s var(--transition-smooth),
                  height 0.4s var(--transition-smooth);
      position: relative;
      z-index: 1;
    }
    
    .nidana-card.expanded .nidana-content {
      opacity: 1;
      transform: translateY(0);
      padding-bottom: 1.5rem;
    }
    
    .nidana-description {
      margin-bottom: 1rem;
      line-height: 1.6;
      position: relative;
    }
    
    /* ===== INTERACTIVE ELEMENTS ===== */
    .glossable {
      text-decoration: underline dotted var(--accent-cyan);
      cursor: pointer;
      position: relative;
      display: inline-block;
      color: var(--accent-cyan);
      transition: color 0.2s ease, text-shadow 0.2s ease;
    }
    
    .glossable:hover {
      color: var(--text-primary);
      text-shadow: 0 0 5px var(--glow-cyan);
    }
    
    .canonical-quote {
      margin: 1.2rem 0;
      padding: 1.2rem;
      border-left: 3px solid var(--accent-gold);
      background: rgba(255, 200, 100, 0.05);
      position: relative;
      font-style: italic;
      transform: translateX(0);
      transition: transform 0.3s var(--transition-smooth),
                  box-shadow 0.3s var(--transition-smooth),
                  background 0.3s var(--transition-smooth);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      border-radius: 0 8px 8px 0;
    }
    
    .canonical-quote:hover {
      transform: translateX(5px);
      background: rgba(255, 200, 100, 0.08);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15),
                 0 0 10px var(--glow-gold);
    }
    
    .canonical-quote::before {
      content: """;
      position: absolute;
      top: 0.5rem;
      left: 0.7rem;
      font-size: 2.5rem;
      color: var(--accent-gold);
      opacity: 0.5;
      font-style: normal;
    }
    
    .quote-source {
      display: block;
      text-align: right;
      margin-top: 0.8rem;
      font-size: 0.8rem;
      color: var(--text-tertiary);
      font-style: normal;
      transition: color 0.3s ease;
    }
    
    .canonical-quote:hover .quote-source {
      color: var(--text-secondary);
    }
    
    .access-link {
      display: inline-block;
      margin-top: 0.5rem;
      color: var(--accent-cyan);
      font-size: 0.8rem;
      text-decoration: none;
      opacity: 0.8;
      transition: opacity 0.3s ease, transform 0.3s ease, text-shadow 0.3s ease;
    }
    
    .access-link:hover {
      opacity: 1;
      transform: translateX(3px);
      text-shadow: 0 0 5px var(--glow-cyan);
    }
    
    .access-link::before {
      content: "→ ";
      display: inline-block;
      transition: transform 0.3s ease;
    }
    
    .access-link:hover::before {
      transform: translateX(3px);
    }
    
    /* ===== TOOLTIP ===== */
    .tooltip {
      position: fixed;
      background: rgba(15, 20, 35, 0.98);
      border: 1px solid rgba(100, 200, 255, 0.15);
      border-radius: 8px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4),
                 0 0 15px var(--glow-cyan);
      padding: 1rem;
      max-width: 280px;
      z-index: 101;
      opacity: 0;
      transform: scale(0.95) translateY(10px);
      transition: opacity 0.3s var(--transition-smooth),
                  transform 0.3s var(--transition-bounce);
      pointer-events: none;
      backdrop-filter: blur(5px);
    }
    
    .tooltip.visible {
      opacity: 1;
      transform: scale(1) translateY(0);
      pointer-events: auto;
    }
    
    .tooltip-title {
      color: var(--accent-cyan);
      margin-bottom: 0.5rem;
      font-size: 1rem;
      border-bottom: 1px solid rgba(100, 200, 255, 0.2);
      padding-bottom: 0.4rem;
    }
    
    .tooltip-content {
      font-size: 0.9rem;
      line-height: 1.5;
      color: var(--text-secondary);
    }
    
    .tooltip::after {
      content: "";
      position: absolute;
      top: -8px;
      left: 50%;
      transform: translateX(-50%);
      border-width: 0 8px 8px;
      border-style: solid;
      border-color: transparent transparent rgba(15, 20, 35, 0.98) transparent;
      filter: drop-shadow(0 -2px 2px rgba(0, 0, 0, 0.1));
    }
    
    /* ===== EXPANDABLE CONCEPTS ===== */
    .expandable-concept {
      margin: 1.2rem 0;
      cursor: pointer;
      background: rgba(150, 255, 180, 0.05);
      border-radius: 8px;
      padding: 0.8rem;
      transition: background 0.3s var(--transition-smooth),
                  box-shadow 0.3s var(--transition-smooth),
                  transform 0.3s var(--transition-smooth);
      border: 1px solid rgba(150, 255, 180, 0.1);
    }
    
    .expandable-concept:hover {
      background: rgba(150, 255, 180, 0.08);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2),
                 0 0 10px var(--glow-mint);
      transform: translateY(-2px);
    }
    
    .expandable-concept.expanded {
      background: rgba(150, 255, 180, 0.08);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2),
                 0 0 15px var(--glow-mint);
    }
    
    .concept-title {
      color: var(--accent-mint);
      display: flex;
      align-items: center;
      font-size: 0.95rem;
      margin-bottom: 0.5rem;
      position: relative;
      z-index: 2;
      transition: color 0.3s ease;
    }
    
    .expandable-concept:hover .concept-title {
      color: var(--text-primary);
    }
    
    .concept-title::before {
      content: "+";
      display: inline-block;
      margin-right: 0.7rem;
      transition: transform 0.3s var(--transition-bounce);
      width: 16px;
      height: 16px;
      text-align: center;
      background: rgba(150, 255, 180, 0.1);
      border-radius: 50%;
      line-height: 16px;
      font-size: 0.9rem;
    }
    
    .expandable-concept.expanded .concept-title::before {
      content: "−";
      background: rgba(150, 255, 180, 0.2);
      transform: rotate(180deg);
    }
    
    .concept-content {
      height: 0;
      overflow: hidden;
      padding-left: 1.5rem;
      transition: height 0.4s var(--transition-smooth);
      opacity: 0;
      transform: translateY(-5px);
      transition: opacity 0.4s var(--transition-smooth),
                  transform 0.4s var(--transition-smooth),
                  height 0.4s var(--transition-smooth);
      color: var(--text-secondary);
      position: relative;
      z-index: 1;
    }
    
    .expandable-concept.expanded .concept-content {
      opacity: 1;
      transform: translateY(0);
    }
    
    /* ===== INTERLINEAR ADDITIONS ===== */
    .interlinear {
      position: relative;
      background: rgba(100, 150, 255, 0.05);
      border-radius: 8px;
      padding: 0.8rem 1rem 1rem;
      margin: 2rem 0 1rem;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s var(--transition-smooth),
                  padding 0.5s var(--transition-smooth),
                  margin 0.5s var(--transition-smooth),
                  opacity 0.5s var(--transition-smooth),
                  box-shadow 0.5s var(--transition-smooth);
      opacity: 0;
      border: 1px solid rgba(100, 150, 255, 0.1);
    }
    
    .interlinear.visible {
      max-height: 300px;
      opacity: 1;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15),
                 0 0 10px var(--glow-blue);
    }
    
    .interlinear::before {
      content: "↓ Deeper insight ↓";
      position: absolute;
      top: -0.8rem;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.7rem;
      background: var(--bg-tertiary);
      padding: 0.3rem 0.7rem;
      border-radius: 4px;
      color: var(--accent-cyan);
      transition: background 0.3s ease, transform 0.3s ease;
      border: 1px solid rgba(100, 200, 255, 0.2);
    }
    
    .interlinear.visible:hover::before {
      background: rgba(100, 150, 255, 0.15);
      transform: translateX(-50%) translateY(-2px);
    }
    
    /* ===== FOLDED CONTENT ===== */
    .folded-content {
      position: relative;
      overflow: hidden;
      height: 0;
      opacity: 0;
      transform: translateY(-10px);
      transition: opacity 0.5s var(--transition-smooth),
                  transform 0.5s var(--transition-smooth),
                  height 0.5s var(--transition-smooth),
                  box-shadow 0.5s var(--transition-smooth),
                  margin 0.5s var(--transition-smooth),
                  padding 0.5s var(--transition-smooth);
      margin: 0;
      padding: 0;
    }
    
    .folded-content.unfolded {
      height: auto;
      opacity: 1;
      transform: translateY(0);
      margin: 1.5rem 0;
      padding: 1.2rem;
      border-left: 3px solid var(--accent-purple);
      background: rgba(180, 120, 255, 0.05);
      border-radius: 0 8px 8px 0;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15),
                 0 0 10px var(--glow-purple);
    }
    
    .fold-trigger {
      cursor: pointer;
      color: var(--accent-purple);
      text-decoration: underline dotted;
      display: inline-block;
      transition: color 0.3s ease, text-shadow 0.3s ease;
      padding: 0.4rem 0;
    }
    
    .fold-trigger:hover {
      color: var(--text-primary);
      text-shadow: 0 0 5px var(--glow-purple);
    }
    
    .fold-trigger::after {
      content: " >";
      display: inline-block;
      transition: transform 0.3s ease;
    }
    
    .fold-trigger:hover::after {
      transform: translateX(3px);
    }
    
    /* ===== COMMENTARY ===== */
    .commentary {
      margin: 1.8rem 0;
      padding: 1.2rem 1.2rem 1.2rem 1.5rem;
      border-left: 3px solid rgba(200, 200, 220, 0.4);
      color: var(--text-secondary);
      font-style: italic;
      font-size: 0.95rem;
      line-height: 1.6;
      position: relative;
      background: rgba(200, 200, 220, 0.03);
      border-radius: 0 8px 8px 0;
      transition: border-left-color 0.3s ease,
                  background 0.3s ease,
                  transform 0.3s ease,
                  box-shadow 0.3s ease;
    }
    
    .commentary:hover {
      border-left-color: rgba(200, 200, 220, 0.6);
      background: rgba(200, 200, 220, 0.05);
      transform: translateX(5px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
    
    .commentary::before {
      content: """;
      position: absolute;
      top: 0.5rem;
      left: 0.7rem;
      font-size: 2rem;
      color: var(--text-tertiary);
      opacity: 0.5;
    }
    
    /* ===== SECTION NAVIGATION ===== */
    .nav-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 2.5rem;
      position: relative;
      z-index: 10;
    }
    
    .nav-button {
      background: rgba(100, 200, 255, 0.1);
      border: 1px solid rgba(100, 200, 255, 0.2);
      color: var(--text-primary);
      padding: 0.7rem 1.2rem;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s var(--transition-smooth),
                  transform 0.3s var(--transition-bounce);
      font-family: var(--font-mono);
      font-size: 0.9rem;
      position: relative;
      overflow: hidden;
    }
    
    .nav-button::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(to right,
                  rgba(100, 200, 255, 0),
                  rgba(100, 200, 255, 0.1));
      transform: translateX(-100%);
      transition: transform 0.4s var(--transition-smooth);
    }
    
    .nav-button:hover {
      background: rgba(100, 200, 255, 0.2);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2),
                 0 0 10px var(--glow-cyan);
    }
    
    .nav-button:hover::before {
      transform: translateX(0);
    }
    
    .nav-button:active {
      transform: translateY(0);
    }
    
    .nav-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: translateY(0);
      box-shadow: none;
    }
    
    .nav-button:disabled:hover::before {
      transform: translateX(-100%);
    }
    
    /* ===== WHEEL VISUALIZATION ===== */
    .wheel-container {
      margin: 2.5rem 0;
      display: flex;
      justify-content: center;
      position: relative;
      perspective: 1000px;
      z-index: 5;
    }
    
    .wheel {
      width: 300px;
      height: 300px;
      border-radius: 50%;
      border: 2px solid var(--accent-gold);
      position: relative;
      box-shadow: 0 0 20px var(--glow-gold);
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(30, 40, 60, 0.4);
      transform-style: preserve-3d;
      transition: transform 0.5s var(--transition-smooth),
                  box-shadow 0.5s var(--transition-smooth);
      will-change: transform, box-shadow;
    }
    
    .wheel:hover {
      box-shadow: 0 0 30px var(--glow-gold);
      transform: rotateX(10deg);
    }
    
    .wheel-segment {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      transform-origin: center;
      cursor: pointer;
      transition: transform 0.3s var(--transition-smooth);
    }
    
    .wheel-segment path {
      fill: rgba(30, 40, 60, 0.7);
      stroke: var(--accent-gold);
      stroke-width: 1;
      transition: fill 0.3s ease, 
                  stroke-width 0.3s ease,
                  stroke 0.3s ease;
      filter: drop-shadow(0 0 2px var(--glow-gold));
    }
    
    .wheel-segment:hover {
      transform: scale(1.03);
    }
    
    .wheel-segment:hover path {
      fill: rgba(255, 200, 100, 0.2);
      stroke-width: 1.5;
      filter: drop-shadow(0 0 5px var(--glow-gold));
    }
    
    .wheel-segment.active path {
      fill: rgba(255, 200, 100, 0.3);
      stroke-width: 2;
      stroke: var(--accent-gold);
      filter: drop-shadow(0 0 8px var(--glow-gold));
    }
    
    .wheel-text {
      position: absolute;
      text-align: center;
      font-size: 0.7rem;
      transform-origin: center;
      width: 60px;
      color: var(--text-secondary);
      pointer-events: none;
      transition: color 0.3s ease, text-shadow 0.3s ease;
      text-shadow: 0 0 1px rgba(0, 0, 0, 0.5);
    }
    
    .wheel-segment:hover + .wheel-text,
    .wheel-segment.active + .wheel-text {
      color: var(--accent-gold);
      text-shadow: 0 0 5px var(--glow-gold);
    }
    
    .wheel-center {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      background: rgba(180, 120, 255, 0.2);
      border: 1px solid var(--accent-purple);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      color: var(--accent-purple);
      text-align: center;
      box-shadow: 0 0 15px var(--glow-purple);
      z-index: 10;
      transform-style: preserve-3d;
      transition: transform 0.4s var(--transition-bounce),
                  box-shadow 0.4s var(--transition-smooth),
                  background 0.4s var(--transition-smooth);
    }
    
    .wheel-center:hover {
      transform: translateZ(10px) scale(1.1);
      background: rgba(180, 120, 255, 0.3);
      box-shadow: 0 0 25px var(--glow-purple);
      cursor: pointer;
    }
    
    /* ===== PINNABLE TOOLTIPS ===== */
    .pin-tooltip {
      position: absolute;
      background: rgba(15, 20, 35, 0.95);
      border: 1px solid rgba(180, 120, 255, 0.3);
      border-radius: 8px;
      padding: 0.75rem;
      width: 220px;
      z-index: 10;
      opacity: 0;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3),
                 0 0 10px var(--glow-purple);
      pointer-events: none;
      transition: opacity 0.3s var(--transition-smooth),
                  transform 0.3s var(--transition-bounce),
                  box-shadow 0.3s var(--transition-smooth);
      font-size: 0.8rem;
      transform: translate(-50%, -120%) scale(0.95);
      backdrop-filter: blur(5px);
    }
    
    .pin-tooltip::after {
      content: "";
      position: absolute;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      border-width: 8px 8px 0;
      border-style: solid;
      border-color: rgba(15, 20, 35, 0.95) transparent transparent transparent;
      transition: border-color 0.3s ease;
    }
    
    .pin-tooltip.visible {
      opacity: 1;
      pointer-events: auto;
      transform: translate(-50%, -120%) scale(1);
    }
    
    .pin-tooltip.pinned {
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4),
                 0 0 15px var(--glow-purple);
      border-color: var(--accent-purple);
    }
    
    .pin-tooltip.pinned::after {
      border-color: var(--accent-purple) transparent transparent transparent;
    }
    
    .pin-button {
      position: absolute;
      right: 5px;
      top: 5px;
      background: none;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      font-size: 0.8rem;
      transition: color 0.3s ease, transform 0.3s ease;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }
    
    .pin-button:hover {
      color: var(--accent-purple);
      transform: scale(1.2);
    }
    
    .pin-tooltip-title {
      color: var(--accent-purple);
      margin-bottom: 0.4rem;
      padding-bottom: 0.3rem;
      border-bottom: 1px solid rgba(180, 120, 255, 0.2);
      padding-right: 20px;
    }
    
    .pin-tooltip-content {
      color: var(--text-secondary);
      line-height: 1.4;
    }
    
    /* ===== ANIMATIONS ===== */
    @keyframes pulse {
      0% { text-shadow: 0 0 8px var(--glow-cyan); }
      50% { text-shadow: 0 0 15px var(--glow-cyan); }
      100% { text-shadow: 0 0 8px var(--glow-cyan); }
    }
    
    @keyframes pulse-gold {
      0% { text-shadow: 0 0 8px var(--glow-gold); box-shadow: 0 0 15px var(--glow-gold); }
      50% { text-shadow: 0 0 15px var(--glow-gold); box-shadow: 0 0 25px var(--glow-gold); }
      100% { text-shadow: 0 0 8px var(--glow-gold); box-shadow: 0 0 15px var(--glow-gold); }
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }
    
    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .pulse {
      animation: pulse 4s infinite ease-in-out;
    }
    
    .pulse-gold {
      animation: pulse-gold 4s infinite ease-in-out;
    }
    
    .float {
      animation: float 6s infinite ease-in-out;
    }
    
    .rotate-slow {
      animation: rotate 60s infinite linear;
    }
    
    /* ===== Scroll Indicator ===== */
    .scroll-indicator {
      position: absolute;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%);
      width: 40px;
      height: 60px;
      display: flex;
      flex-direction: column;
      align-items: center;
      opacity: 0.7;
      transition: opacity 0.3s ease, transform 0.3s ease;
      z-index: 10;
      pointer-events: none;
    }
    
    .scroll-indicator:hover {
      opacity: 1;
    }
    
    .scroll-arrow {
      width: 20px;
      height: 20px;
      border-right: 2px solid var(--accent-cyan);
      border-bottom: 2px solid var(--accent-cyan);
      transform: rotate(45deg);
      margin-bottom: -10px;
      opacity: 0;
      animation: scroll-arrow-appear 2s infinite;
      box-shadow: 2px 2px 5px var(--glow-cyan);
    }
    
    .scroll-arrow:nth-child(2) {
      animation-delay: 0.5s;
    }
    
    .scroll-arrow:nth-child(3) {
      animation-delay: 1s;
    }
    
    @keyframes scroll-arrow-appear {
      0% { opacity: 0; transform: rotate(45deg) translateY(-10px); }
      50% { opacity: 1; transform: rotate(45deg) translateY(0); }
      100% { opacity: 0; transform: rotate(45deg) translateY(10px); }
    }
    
    /* ===== RESPONSIVE ADJUSTMENTS ===== */
    @media (max-width: 400px) {
      .mobile-container {
        width: 100%;
        height: 100vh;
        border-radius: 0;
      }
      
      .wheel {
        width: 280px;
        height: 280px;
      }
      
      .section {
        padding: 1.5rem 1rem;
      }
    }
    
    /* ===== Parallax Background ===== */
    .parallax-stars {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 200%;
      pointer-events: none;
      z-index: 0;
    }
    
    .star {
      position: absolute;
      width: 2px;
      height: 2px;
      background-color: rgba(255, 255, 255, 0.5);
      border-radius: 50%;
    }
    
    .star.medium {
      width: 3px;
      height: 3px;
      background-color: rgba(255, 255, 255, 0.7);
    }
    
    .star.large {
      width: 4px;
      height: 4px;
      background-color: rgba(255, 255, 255, 0.9);
      box-shadow: 0 0 4px rgba(255, 255, 255, 0.5);
    }
    
    /* ===== Highlight effect ===== */
    .highlight-effect {
      position: absolute;
      width: 100%;
      height: 100%;
      pointer-events: none;
      opacity: 0;
      z-index: 2;
      background: radial-gradient(
        circle at var(--x, 50%) var(--y, 50%),
        rgba(100, 200, 255, 0.2) 0%,
        rgba(100, 200, 255, 0) 50%
      );
      transition: opacity 1s ease;
    }
  </style>
</head>
<body>
  <div class="mobile-container">
    <div class="content-area" id="contentArea">
      <!-- Parallax Background -->
      <div class="parallax-stars" id="parallaxStars"></div>
      
      <!-- Mouse highlight effect -->
      <div class="highlight-effect" id="highlightEffect"></div>

      <!-- Splash Screen -->
      <div class="splash-screen" id="splashScreen">
        <h1 class="splash-title pulse">Paṭicca-samuppāda</h1>
        <p class="splash-subtitle">Scroll to explore the chain of dependent origination</p>
        <div class="scroll-indicator">
          <div class="scroll-arrow"></div>
          <div class="scroll-arrow"></div>
          <div class="scroll-arrow"></div>
        </div>
      </div>

      <!-- Introduction Section -->
      <section class="section" id="introduction">
        <div class="section-background"></div>
        <h2 class="section-title">The Twelve Nidānas</h2>
        <p class="section-subtitle">Exploring the links of dependent origination</p>
        
        <p class="nidana-description">
          The Buddha's teaching on <span class="glossable" data-title="Dependent Origination" data-content="The principle that all phenomena arise dependent on causes and conditions, and cease when those conditions cease.">Paṭicca-samuppāda</span> reveals how our experience of suffering arises through a chain of twelve causal links or nidānas. By understanding these links, we can see the path to liberation.
        </p>
        
        <p class="nidana-description">
          Each nidāna represents a condition that leads to the arising of subsequent conditions, illustrating the cyclical nature of <span class="glossable" data-title="Saṃsāra" data-content="The cycle of repeated birth, death and rebirth within the six realms of existence.">saṃsāra</span>.
        </p>
        
        <div class="wheel-container">
          <div class="wheel" id="wheel">
            <svg viewBox="0 0 300 300" width="300" height="300">
              <!-- Wheel segments will be created by JavaScript -->
            </svg>
            <div class="wheel-center">Dependent Arising</div>
          </div>
        </div>
        
        <div class="commentary">
          Click each segment on the wheel to explore its meaning, or scroll down to explore each nidāna in sequence. The foldouts, tooltips, and expandable sections provide deeper insights into the Buddha's teaching.
        </div>
        
        <a href="https://www.accesstoinsight.org/tipitaka/sn/sn12/sn12.002.than.html" target="_blank" class="access-link">
          Read the Analysis of Dependent Co-arising at Access to Insight
        </a>
      </section>
      
      <!-- Nidanas Section -->
      <section class="section" id="nidanas">
        <div class="section-background"></div>
        <ul class="nidana-list" id="nidanaList">
          <!-- Nidana items will be created by JavaScript -->
        </ul>
        
        <div class="commentary">
          "When this exists, that exists; when this ceases to exist, that also ceases to exist." This is the essential principle of dependent origination, showing how all phenomena are interconnected.
        </div>
        
        <a href="https://www.accesstoinsight.org/lib/study/dependent.html" target="_blank" class="access-link">
          Explore a study guide on Dependent Co-arising at Access to Insight
        </a>
        
        <div class="nav-buttons">
          <button class="nav-button" id="prevButton" disabled>Previous</button>
          <button class="nav-button" id="nextButton">Next Nidāna</button>
        </div>
      </section>
    </div>
  </div>
  
  <!-- Tooltip -->
  <div class="tooltip" id="tooltip">
    <h3 class="tooltip-title" id="tooltipTitle"></h3>
    <div class="tooltip-content" id="tooltipContent"></div>
  </div>

  <script>
    // ===== DATA =====
    // Define the nidanas with their details
    const nidanas = [
      {
        number: 1,
        term: "avijjā",
        meaning: "Ignorance",
        description: "Ignorance of the Four Noble Truths and the true nature of reality. In the Buddhist sense, it refers to not understanding how things truly are.",
        quote: "And what is ignorance? Not knowing suffering, not knowing the origin of suffering, not knowing the cessation of suffering, not knowing the way leading to the cessation of suffering: this is called ignorance.",
        source: "Sammādiṭṭhi Sutta (MN 9)",
        accessUrl: "https://www.accesstoinsight.org/tipitaka/mn/mn.009.ntbb.html",
        concepts: [
          {
            title: "Forms of Ignorance",
            content: "Ignorance manifests as not understanding impermanence (anicca), unsatisfactoriness (dukkha), and non-self (anattā). It is the fundamental misperception that leads to craving and suffering."
          },
          {
            title: "Cognitive Obscuration",
            content: "Avijjā functions as a cognitive obscuration that prevents seeing things as they truly are. The Buddha compared it to a cataract that obscures vision."
          }
        ],
        interlinear: "The Buddha described ignorance as a kind of 'blind-spot' in our understanding. It's not simply 'not knowing' something, but an active misperception of reality—taking what is impermanent to be permanent, what is unsatisfactory to be satisfactory, and what is not-self to be self."
      },
      {
        number: 2,
        term: "saṅkhāra",
        meaning: "Volitional Formations",
        description: "Mental formations and volitions that arise from ignorance. These are the intentional activities that create karma and condition consciousness.",
        quote: "And what are fabrications? These three are fabrications: bodily fabrications, verbal fabrications, mental fabrications.",
        source: "Paticca-samuppada-vibhanga Sutta (SN 12.2)",
        accessUrl: "https://www.accesstoinsight.org/tipitaka/sn/sn12/sn12.002.than.html",
        concepts: [
          {
            title: "Types of Saṅkhāra",
            content: "According to the suttas, there are three types: bodily fabrications (in-and-out breathing), verbal fabrications (directed thought and evaluation), and mental fabrications (perception and feeling)."
          },
          {
            title: "Kammic Force",
            content: "Saṅkhāras function as the kammic force that propels beings through the cycle of rebirth. They are the volitional activities that determine one's future existence."
          }
        ],
        interlinear: "Saṅkhāra has a dual meaning in Buddhism: both 'that which puts together' (the active process of formation) and 'that which has been put together' (the conditioned phenomena). The Buddha's last words referenced saṅkhāra: 'All conditioned things are subject to decay. Strive diligently!'"
      },
      {
        number: 3,
        term: "viññāṇa",
        meaning: "Consciousness",
        description: "The awareness that arises dependent on sense organs and their objects. In the context of dependent origination, it's also the consciousness that links one life to the next.",
        quote: "And what is consciousness? These six are classes of consciousness: eye-consciousness, ear-consciousness, nose-consciousness, tongue-consciousness, body-consciousness, intellect-consciousness. This is called consciousness.",
        source: "Paticca-samuppada-vibhanga Sutta (SN 12.2)",
        accessUrl: "https://www.accesstoinsight.org/tipitaka/sn/sn12/sn12.002.than.html",
        concepts: [
          {
            title: "Six Types of Consciousness",
            content: "Consciousness is divided into six types according to the six sense bases: consciousness of sights, sounds, smells, tastes, physical sensations, and mental objects."
          },
          {
            title: "Relinking Consciousness",
            content: "In the context of rebirth, viññāṇa is the 'stream of consciousness' that continues from one life to the next, conditioned by past karma (saṅkhāras)."
          }
        ],
        interlinear: "Viññāṇa exists in mutual dependence with nāmarūpa (name-and-form). In the Mahānidāna Sutta, the Buddha explained to Ānanda that consciousness and name-and-form condition each other like two sheaves of reeds standing by supporting one another."
      },
      {
        number: 4,
        term: "nāmarūpa",
        meaning: "Name and Form",
        description: "The psycho-physical complex comprising mental factors (nāma) and physical form (rūpa). This is the mind-body organism that serves as the basis for experience.",
        quote: "And what is name-and-form? Feeling, perception, intention, contact, and attention: This is called name. The four great elements, and the form dependent on the four great elements: This is called form.",
        source: "Paticca-samuppada-vibhanga Sutta (SN 12.2)",
        accessUrl: "https://www.accesstoinsight.org/tipitaka/sn/sn12/sn12.002.than.html",
        concepts: [
          {
            title: "Name (Nāma)",
            content: "The mental aspects including feeling (vedanā), perception (saññā), intention (cetanā), contact (phassa), and attention (manasikāra)."
          },
          {
            title: "Form (Rūpa)",
            content: "The physical aspects including the four great elements (earth/solidity, water/cohesion, fire/temperature, air/motion) and all material form derived from them."
          }
        ],
        interlinear: "The term nāmarūpa has ancient roots in pre-Buddhist Vedic thought, where it referred to the principle of individuation. The Buddha redefined it within his system to describe the interdependent mental and physical processes that constitute a sentient being."
      },
      {
        number: 5,
        term: "saḷāyatana",
        meaning: "Six Sense Bases",
        description: "The six internal sense bases (eye, ear, nose, tongue, body, and mind) and their corresponding external objects. These are the gateways through which experience occurs.",
        quote: "And what are the six sense media? These six are sense media: the eye-medium, the ear-medium, the nose-medium, the tongue-medium, the body-medium, the intellect-medium.",
        source: "Paticca-samuppada-vibhanga Sutta (SN 12.2)",
        accessUrl: "https://www.accesstoinsight.org/tipitaka/sn/sn12/sn12.002.than.html",
        concepts: [
          {
            title: "Internal and External Bases",
            content: "Each sense base has both an internal aspect (the sense organ) and an external aspect (the corresponding objects). The eye and visible forms, the ear and sounds, and so on."
          },
          {
            title: "Mind as Sixth Sense",
            content: "Unlike Western models, Buddhism considers the mind (mano) as a sixth sense base that perceives mental objects (dhammā) such as thoughts, ideas, and memories."
          }
        ],
        interlinear: "The Sanskrit term 'āyatana' conveys the sense of a 'sphere' or 'field' of experience. Each sense base provides a distinct field through which consciousness engages with the world, creating the conditions for contact (phassa)."
      },
      {
        number: 6,
        term: "phassa",
        meaning: "Contact",
        description: "The coming together of sense organ, sense object, and the corresponding consciousness. This tripartite meeting is the basis for all experience.",
        quote: "And what is contact? These six are classes of contact: eye-contact, ear-contact, nose-contact, tongue-contact, body-contact, intellect-contact. This is called contact.",
        source: "Paticca-samuppada-vibhanga Sutta (SN 12.2)",
        accessUrl: "https://www.accesstoinsight.org/tipitaka/sn/sn12/sn12.002.than.html",
        concepts: [
          {
            title: "Tripartite Meeting",
            content: "Contact requires three factors: the sense organ, the sense object, and the corresponding consciousness. When these three meet, contact occurs."
          },
          {
            title: "Gateway to Experience",
            content: "Phassa serves as the gateway through which the external world affects us. Without contact, no experience would be possible."
          }
        ],
        interlinear: "In the Madhupiṇḍika Sutta, the Buddha explained that dependent on contact, feeling arises; what one feels, one perceives; what one perceives, one thinks about; what one thinks about, one mentally proliferates. This shows how contact initiates the entire process of cognitive experience."
      },
      {
        number: 7,
        term: "vedanā",
        meaning: "Feeling",
        description: "The affective tone that arises from contact with sense objects. Feelings are categorized as pleasant, unpleasant, or neutral.",
        quote: "And what is feeling? These six are classes of feeling: feeling born from eye-contact, feeling born from ear-contact, feeling born from nose-contact, feeling born from tongue-contact, feeling born from body-contact, feeling born from intellect-contact.",
        source: "Paticca-samuppada-vibhanga Sutta (SN 12.2)",
        accessUrl: "https://www.accesstoinsight.org/tipitaka/sn/sn12/sn12.002.than.html",
        concepts: [
          {
            title: "Three Types of Feeling",
            content: "According to the Buddha, feelings are always one of three types: pleasant (sukha), unpleasant (dukkha), or neutral (adukkhamasukha)."
          },
          {
            title: "Feeling vs. Emotion",
            content: "Vedanā differs from the Western concept of emotion. It refers specifically to the pleasant, unpleasant, or neutral tone of experience, which may then condition more complex emotional states."
          }
        ],
        interlinear: "The Buddha emphasized the importance of mindfulness of feeling (vedanānupassanā) because this is the critical juncture where craving arises. By observing feelings with mindfulness instead of reacting, we can interrupt the chain of dependent origination."
      },
      {
        number: 8,
        term: "taṇhā",
        meaning: "Craving",
        description: "The thirst or desire that arises based on feeling. It manifests as craving for sensual pleasures, craving for existence, and craving for non-existence.",
        quote: "And what is craving? These six are classes of craving: craving for forms, craving for sounds, craving for smells, craving for tastes, craving for tactile sensations, craving for ideas.",
        source: "Paticca-samuppada-vibhanga Sutta (SN 12.2)",
        accessUrl: "https://www.accesstoinsight.org/tipitaka/sn/sn12/sn12.002.than.html",
        concepts: [
          {
            title: "Three Types of Craving",
            content: "The Buddha identified three types of craving: kāma-taṇhā (craving for sensual pleasures), bhava-taṇhā (craving for continued existence), and vibhava-taṇhā (craving for non-existence)."
          },
          {
            title: "Second Noble Truth",
            content: "Taṇhā features prominently in the Second Noble Truth as the cause of suffering (dukkha-samudaya). It's the driving force that perpetuates the cycle of rebirth."
          }
        ],
        interlinear: "The Pali word 'taṇhā' literally means 'thirst' and conveys a powerful sense of insatiable desire. The Buddha compared it to a fire that can never be satisfied no matter how much fuel it consumes."
      },
      {
        number: 9,
        term: "upādāna",
        meaning: "Clinging",
        description: "The intensified form of craving that leads to attachment and appropriation. It manifests as clinging to sensual pleasures, views, rules and observances, and theories of self.",
        quote: "And what is clinging/sustenance? These four are clingings: clinging to sensuality, clinging to views, clinging to precepts and practices, clinging to doctrines of self.",
        source: "Paticca-samuppada-vibhanga Sutta (SN 12.2)",
        accessUrl: "https://www.accesstoinsight.org/tipitaka/sn/sn12/sn12.002.than.html",
        concepts: [
          {
            title: "Four Types of Clinging",
            content: "The Buddha described four types: kāmupādāna (clinging to sensual pleasures), diṭṭhupādāna (clinging to views), sīlabbatupādāna (clinging to rules and observances), and attavādupādāna (clinging to theories of self)."
          },
          {
            title: "Fuel for Becoming",
            content: "The term upādāna also means 'fuel' or 'nutriment', suggesting that clinging acts as the fuel that sustains the process of becoming (bhava)."
          }
        ],
        interlinear: "While taṇhā (craving) represents the initial impulse of desire, upādāna represents a stronger, more developed form of attachment where one actively grasps and appropriates objects, experiences, or views as 'mine'."
      },
      {
        number: 10,
        term: "bhava",
        meaning: "Becoming",
        description: "The process of coming into existence in a particular realm. It represents both the active process of producing a new existence and the state of existence itself.",
        quote: "And what is becoming? These three are becomings: sensual becoming, form becoming, formless becoming. This is called becoming.",
        source: "Paticca-samuppada-vibhanga Sutta (SN 12.2)",
        accessUrl: "https://www.accesstoinsight.org/tipitaka/sn/sn12/sn12.002.than.html",
        concepts: [
          {
            title: "Three Realms of Becoming",
            content: "The Buddha described three types: kāma-bhava (becoming in the sensual realm), rūpa-bhava (becoming in the form realm), and arūpa-bhava (becoming in the formless realm)."
          },
          {
            title: "Dual Aspect",
            content: "Bhava has both an active aspect (kamma-bhava) referring to the actions that produce rebirth, and a passive aspect (upapatti-bhava) referring to the resultant rebirth itself."
          }
        ],
        interlinear: "The process of becoming (bhava) is where the accumulation of kamma finally begins to bear fruit, creating the conditions for specific forms of rebirth. It's the penultimate link before the actual manifestation of a new birth."
      },
      {
        number: 11,
        term: "jāti",
        meaning: "Birth",
        description: "The manifestation of the five aggregates in a new existence. In the context of dependent origination, it refers to the beginning of a new life conditioned by previous becoming.",
        quote: "And what is birth? Whatever birth, taking birth, descent, coming-to-be, coming-forth, appearance of aggregates, and acquisition of sense media of the various beings in this or that group of beings, that is called birth.",
        source: "Paticca-samuppada-vibhanga Sutta (SN 12.2)",
        accessUrl: "https://www.accesstoinsight.org/tipitaka/sn/sn12/sn12.002.than.html",
        concepts: [
          {
            title: "Manifestation of Aggregates",
            content: "Birth (jāti) refers to the manifestation of a new set of five aggregates (form, feeling, perception, mental formations, and consciousness) at the beginning of a life."
          },
          {
            title: "Moment-to-Moment Birth",
            content: "On a subtler level, jāti can also refer to the moment-to-moment 'birth' of phenomena in our experience as we continuously generate new states of becoming."
          }
        ],
        interlinear: "The Buddha emphasized that birth itself is suffering because it inevitably leads to aging, illness, and death. The recognition of this fundamental unsatisfactoriness of existence motivates the search for liberation from the cycle."
      },
      {
        number: 12,
        term: "jarāmaraṇa",
        meaning: "Aging and Death",
        description: "The inevitable processes of decay and dissolution that follow birth. This final link completes the cycle, as the suffering associated with aging and death conditions ignorance, starting the cycle again.",
        quote: "And what is aging and death? Whatever aging, decrepitude, brokenness, graying, wrinkling, decline of life-force, weakening of the faculties... Whatever falling away, perishing, breaking up, disappearance, dying, death...",
        source: "Paticca-samuppada-vibhanga Sutta (SN 12.2)",
        accessUrl: "https://www.accesstoinsight.org/tipitaka/sn/sn12/sn12.002.than.html",
        concepts: [
          {
            title: "Universal Characteristic",
            content: "Aging and death are universal characteristics of all conditioned phenomena, not just living beings. Everything that arises must eventually cease."
          },
          {
            title: "Closing the Circle",
            content: "Jarāmaraṇa completes the circle of dependent origination, as the suffering associated with aging and death gives rise to confusion and ignorance (avijjā), beginning the cycle anew."
          }
        ],
        interlinear: "The Buddha's own spiritual journey began when he encountered the existential reality of aging, illness, and death during his famous chariot rides outside the palace. This recognition of mortality led him to seek a path beyond suffering."
      }
    ];

    // ===== INITIALIZATION =====
    document.addEventListener("DOMContentLoaded", function() {
      // Create parallax stars
      createParallaxStars();
      
      // Set up highlight effect
      setupHighlightEffect();
      
      // Hide splash screen on scroll
      const splashScreen = document.getElementById("splashScreen");
      const contentArea = document.getElementById("contentArea");
      
      contentArea.addEventListener("scroll", function() {
        if (contentArea.scrollTop > 20) {
          splashScreen.classList.add("hide");
        }
        
        // Update parallax effect
        updateParallax();
        
        // Check for sections in view
        checkSectionsInView();
        
        // Check for nidana items in view
        checkNidanaItemsInView();
      });
      
      // Create the wheel visualization
      createWheel();
      
      // Create nidana list items
      createNidanaList();
      
      // Set up glossable terms
      setupGlossableTerms();
      
      // Set up navigation buttons
      setupNavigation();
      
      // Set the wheel to slowly rotate
      document.querySelector("#wheel svg").classList.add("rotate-slow");
      
      // After a delay, add a hint to scroll
      setTimeout(() => {
        if (!splashScreen.classList.contains("hide")) {
          splashScreen.classList.add("pulse");
        }
      }, 3000);
      
      // Initial check for elements in view
      setTimeout(() => {
        checkSectionsInView();
        checkNidanaItemsInView();
      }, 500);
    });
    
    // ===== PARALLAX STARS =====
    function createParallaxStars() {
      const starsContainer = document.getElementById("parallaxStars");
      const numStars = 100;
      
      for (let i = 0; i < numStars; i++) {
        const star = document.createElement("div");
        star.classList.add("star");
        
        // Randomly position stars
        const x = Math.random() * 100;
        const y = Math.random() * 100;
        star.style.left = `${x}%`;
        star.style.top = `${y}%`;
        
        // Randomly assign star sizes
        const size = Math.random();
        if (size > 0.9) {
          star.classList.add("large");
        } else if (size > 0.7) {
          star.classList.add("medium");
        }
        
        starsContainer.appendChild(star);
      }
    }
    
    function updateParallax() {
      const scrollY = document.getElementById("contentArea").scrollTop;
      const stars = document.querySelectorAll(".star");
      
      stars.forEach((star, index) => {
        // Different parallax speeds based on star size
        let speed = 0.2;
        if (star.classList.contains("medium")) {
          speed = 0.3;
        } else if (star.classList.contains("large")) {
          speed = 0.4;
        }
        
        // Apply parallax transform
        const yPos = -scrollY * speed;
        star.style.transform = `translateY(${yPos}px)`;
      });
    }
    
    // ===== HIGHLIGHT EFFECT =====
    function setupHighlightEffect() {
      const highlightEffect = document.getElementById("highlightEffect");
      const contentArea = document.getElementById("contentArea");
      
      contentArea.addEventListener("mousemove", (e) => {
        // Get mouse position relative to content area
        const rect = contentArea.getBoundingClientRect();
        const x = ((e.clientX - rect.left) / rect.width) * 100;
        const y = ((e.clientY - rect.top) / rect.height) * 100;
        
        // Update CSS custom properties
        highlightEffect.style.setProperty("--x", `${x}%`);
        highlightEffect.style.setProperty("--y", `${y}%`);
        
        // Show highlight effect
        highlightEffect.style.opacity = 0.3;
      });
      
      contentArea.addEventListener("mouseleave", () => {
        highlightEffect.style.opacity = 0;
      });
    }
    
    // ===== CHECK ELEMENTS IN VIEW =====
    function checkSectionsInView() {
      const sections = document.querySelectorAll(".section");
      
      sections.forEach(section => {
        if (isElementInView(section)) {
          section.classList.add("visible");
        }
      });
    }
    
    function checkNidanaItemsInView() {
      const nidanaItems = document.querySelectorAll(".nidana-item");
      
      nidanaItems.forEach((item, index) => {
        // Add staggered delay to create cascade effect
        setTimeout(() => {
          if (isElementInView(item)) {
            item.classList.add("visible");
          }
        }, index * 100);
      });
    }
    
    function isElementInView(element) {
      const contentArea = document.getElementById("contentArea");
      const contentRect = contentArea.getBoundingClientRect();
      const elementRect = element.getBoundingClientRect();
      
      // Check if element is in viewport or slightly above
      return (
        elementRect.top < contentRect.bottom - 100 &&
        elementRect.bottom > contentRect.top + 100
      );
    }
    
    // ===== WHEEL VISUALIZATION =====
    function createWheel() {
      const wheelSvg = document.querySelector("#wheel svg");
      const segmentAngle = 360 / nidanas.length;
      const centerX = 150;
      const centerY = 150;
      const radius = 145;
      
      nidanas.forEach((nidana, index) => {
        // Calculate start and end angles for segment
        const startAngle = index * segmentAngle;
        const endAngle = (index + 1) * segmentAngle;
        
        // Convert angles to radians
        const startRadians = (startAngle - 90) * Math.PI / 180;
        const endRadians = (endAngle - 90) * Math.PI / 180;
        
        // Calculate points
        const innerRadius = 60;
        const x1 = centerX + innerRadius * Math.cos(startRadians);
        const y1 = centerY + innerRadius * Math.sin(startRadians);
        const x2 = centerX + radius * Math.cos(startRadians);
        const y2 = centerY + radius * Math.sin(startRadians);
        const x3 = centerX + radius * Math.cos(endRadians);
        const y3 = centerY + radius * Math.sin(endRadians);
        const x4 = centerX + innerRadius * Math.cos(endRadians);
        const y4 = centerY + innerRadius * Math.sin(endRadians);
        
        // Create segment path
        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        path.setAttribute("d", `M ${x1} ${y1} L ${x2} ${y2} A ${radius} ${radius} 0 0 1 ${x3} ${y3} L ${x4} ${y4} A ${innerRadius} ${innerRadius} 0 0 0 ${x1} ${y1}`);
        
        // Create segment group
        const segment = document.createElementNS("http://www.w3.org/2000/svg", "g");
        segment.classList.add("wheel-segment");
        segment.setAttribute("data-index", index);
        segment.appendChild(path);
        
        // Add click event
        segment.addEventListener("click", function() {
          highlightNidana(index);
          scrollToNidana(index);
        });
        
        wheelSvg.appendChild(segment);
        
        // Add segment text
        const textAngle = startAngle + (segmentAngle / 2);
        const textRadians = (textAngle - 90) * Math.PI / 180;
        const textDistance = (innerRadius + radius) / 2;
        const textX = centerX + textDistance * Math.cos(textRadians);
        const textY = centerY + textDistance * Math.sin(textRadians);
        
        const text = document.createElement("div");
        text.classList.add("wheel-text");
        text.textContent = `${index + 1}. ${nidana.term}`;
        text.style.left = `${textX}px`;
        text.style.top = `${textY}px`;
        text.style.transform = `translate(-50%, -50%) rotate(${textAngle}deg)`;
        
        document.querySelector("#wheel").appendChild(text);
      });
      
      // Add wheel center click event
      document.querySelector(".wheel-center").addEventListener("click", function() {
        // Create a pinnable tooltip about dependent origination
        createPinnableTooltip(
          this,
          "Paṭicca-samuppāda",
          "The central teaching on dependent origination shows how suffering arises through a chain of conditions and how it can be ended. Understanding this process is key to liberation from the cycle of birth and death."
        );
      });
    }
    
    function highlightNidana(index) {
      // Remove active class from all segments
      document.querySelectorAll(".wheel-segment").forEach(segment => {
        segment.classList.remove("active");
      });
      
      // Add active class to selected segment
      document.querySelector(`.wheel-segment[data-index="${index}"]`).classList.add("active");
      
      // Apply pulse effect to the wheel
      const wheel = document.querySelector(".wheel");
      wheel.classList.add("pulse-gold");
      
      // Remove pulse effect after animation
      setTimeout(() => {
        wheel.classList.remove("pulse-gold");
      }, 1500);
    }
    
    // ===== NIDANA LIST =====
    function createNidanaList() {
      const nidanaList = document.getElementById("nidanaList");
      
      nidanas.forEach((nidana, index) => {
        const nidanaItem = document.createElement("li");
        nidanaItem.classList.add("nidana-item");
        nidanaItem.setAttribute("id", `nidana-${index + 1}`);
        
        // Create card
        const nidanaCard = document.createElement("div");
        nidanaCard.classList.add("nidana-card");
        
        // Create header
        const nidanaHeader = document.createElement("div");
        nidanaHeader.classList.add("nidana-header");
        nidanaHeader.innerHTML = `
          <span class="nidana-number">${nidana.number}.</span>
          <span class="nidana-term">${nidana.term}</span>
          <span class="nidana-meaning">${nidana.meaning}</span>
          <span class="expand-icon">↓</span>
        `;
        
        // Add 3D tilt effect on mouse move
        nidanaHeader.addEventListener("mousemove", function(e) {
          const card = this.parentElement;
          const rect = card.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          
          // Calculate tilt values
          const tiltX = (y / rect.height - 0.5) * 10;
          const tiltY = (x / rect.width - 0.5) * -10;
          
          // Apply tilt and add subtle movement
          card.style.transform = `perspective(1000px) rotateX(${tiltX}deg) rotateY(${tiltY}deg) translateZ(10px)`;
        });
        
        // Reset card position on mouse leave
        nidanaHeader.addEventListener("mouseleave", function() {
          const card = this.parentElement;
          card.style.transform = "";
        });
        
        nidanaHeader.addEventListener("click", function() {
          toggleNidanaContent(nidanaCard, nidana);
        });
        
        // Create content container
        const nidanaContent = document.createElement("div");
        nidanaContent.classList.add("nidana-content");
        
        nidanaCard.appendChild(nidanaHeader);
        nidanaCard.appendChild(nidanaContent);
        nidanaItem.appendChild(nidanaCard);
        nidanaList.appendChild(nidanaItem);
      });
    }
    
    function toggleNidanaContent(card, nidana) {
      const content = card.querySelector(".nidana-content");
      
      if (card.classList.contains("expanded")) {
        // Close the card
        card.classList.remove("expanded");
        content.style.height = "0";
      } else {
        // Close any open cards
        document.querySelectorAll(".nidana-card.expanded").forEach(openCard => {
          openCard.classList.remove("expanded");
          openCard.querySelector(".nidana-content").style.height = "0";
        });
        
        // Open the card
        card.classList.add("expanded");
        
        // Populate content if empty
        if (!content.hasChildNodes()) {
          populateNidanaContent(content, nidana);
        }
        
        // Set height for animation
        content.style.height = content.scrollHeight + "px";
        
        // Highlight on wheel
        highlightNidana(nidana.number - 1);
      }
    }
    
    function populateNidanaContent(contentElement, nidana) {
      // Description
      const description = document.createElement("p");
      description.classList.add("nidana-description");
      description.textContent = nidana.description;
      contentElement.appendChild(description);
      
      // Canonical quote
      if (nidana.quote) {
        const quoteContainer = document.createElement("div");
        quoteContainer.classList.add("canonical-quote");
        quoteContainer.innerHTML = `
          "${nidana.quote}"
          <span class="quote-source">${nidana.source}</span>
        `;
        
        // Add Access to Insight link
        if (nidana.accessUrl) {
          const accessLink = document.createElement("a");
          accessLink.classList.add("access-link");
          accessLink.href = nidana.accessUrl;
          accessLink.target = "_blank";
          accessLink.textContent = "Read in context at Access to Insight";
          quoteContainer.appendChild(accessLink);
        }
        
        contentElement.appendChild(quoteContainer);
      }
      
      // Expandable concepts
      if (nidana.concepts && nidana.concepts.length > 0) {
        nidana.concepts.forEach(concept => {
          const conceptElement = document.createElement("div");
          conceptElement.classList.add("expandable-concept");
          
          const conceptTitle = document.createElement("div");
          conceptTitle.classList.add("concept-title");
          conceptTitle.textContent = concept.title;
          
          const conceptContent = document.createElement("div");
          conceptContent.classList.add("concept-content");
          conceptContent.textContent = concept.content;
          
          conceptElement.appendChild(conceptTitle);
          conceptElement.appendChild(conceptContent);
          
          conceptElement.addEventListener("click", function(event) {
            // Prevent bubbling to parent elements
            event.stopPropagation();
            
            toggleConcept(conceptElement);
          });
          
          contentElement.appendChild(conceptElement);
        });
      }
      
      // Interlinear content
      if (nidana.interlinear) {
        const interlinear = document.createElement("div");
        interlinear.classList.add("interlinear");
        interlinear.textContent = nidana.interlinear;
        
        contentElement.appendChild(interlinear);
        
        // Add a trigger to show the interlinear with delay
        setTimeout(() => {
          interlinear.classList.add("visible");
        }, 1000);
      }
      
      // Add fold trigger and folded content if there are concepts
      if (nidana.concepts && nidana.concepts.length > 0) {
        const foldTrigger = document.createElement("div");
        foldTrigger.classList.add("fold-trigger");
        foldTrigger.textContent = "Explore deeper implications...";
        contentElement.appendChild(foldTrigger);
        
        const foldedContent = document.createElement("div");
        foldedContent.classList.add("folded-content");
        foldedContent.innerHTML = `
          <p>The ${nidana.term} link in the chain of dependent origination shows how our experience is constructed moment by moment. By examining this process mindfully, we can see the impermanent, conditioned nature of all phenomena.</p>
          <p>Understanding this link is crucial for seeing the path to liberation, as it reveals a point where the cycle can be broken through wisdom and mindfulness.</p>
        `;
        contentElement.appendChild(foldedContent);
        
        foldTrigger.addEventListener("click", function(event) {
          event.stopPropagation();
          foldedContent.classList.toggle("unfolded");
          foldTrigger.textContent = foldedContent.classList.contains("unfolded") ? 
            "Hide details..." : "Explore deeper implications...";
        });
      }
    }
    
    function toggleConcept(conceptElement) {
      const content = conceptElement.querySelector(".concept-content");
      
      if (conceptElement.classList.contains("expanded")) {
        // Close the concept
        conceptElement.classList.remove("expanded");
        content.style.height = "0";
      } else {
        // Open the concept
        conceptElement.classList.add("expanded");
        content.style.height = content.scrollHeight + "px";
      }
    }
    
    // ===== GLOSSABLE TERMS =====
    function setupGlossableTerms() {
      const glossableTerms = document.querySelectorAll(".glossable");
      const tooltip = document.getElementById("tooltip");
      const tooltipTitle = document.getElementById("tooltipTitle");
      const tooltipContent = document.getElementById("tooltipContent");
      
      glossableTerms.forEach(term => {
        term.addEventListener("mouseenter", function(event) {
          // Position the tooltip
          const rect = term.getBoundingClientRect();
          tooltip.style.left = (rect.left + rect.width / 2) + "px";
          tooltip.style.top = (rect.top - 15) + "px";
          
          // Set tooltip content
          tooltipTitle.textContent = term.getAttribute("data-title");
          tooltipContent.textContent = term.getAttribute("data-content");
          
          // Show the tooltip
          tooltip.classList.add("visible");
        });
        
        term.addEventListener("mouseleave", function() {
          // Hide the tooltip
          tooltip.classList.remove("visible");
        });
        
        // Add click behavior for mobile
        term.addEventListener("click", function(event) {
          event.stopPropagation();
          
          // Toggle tooltip visibility
          if (tooltip.classList.contains("visible")) {
            tooltip.classList.remove("visible");
          } else {
            // Position the tooltip
            const rect = term.getBoundingClientRect();
            tooltip.style.left = (rect.left + rect.width / 2) + "px";
            tooltip.style.top = (rect.top - 15) + "px";
            
            // Set tooltip content
            tooltipTitle.textContent = term.getAttribute("data-title");
            tooltipContent.textContent = term.getAttribute("data-content");
            
            // Show the tooltip
            tooltip.classList.add("visible");
          }
        });
      });
      
      // Close tooltip when clicking outside
      document.addEventListener("click", function(event) {
        if (!event.target.closest(".glossable") && !event.target.closest(".tooltip")) {
          tooltip.classList.remove("visible");
        }
      });
    }
    
    // ===== NAVIGATION =====
    function setupNavigation() {
      const prevButton = document.getElementById("prevButton");
      const nextButton = document.getElementById("nextButton");
      let currentNidana = 0;
      
      // Next button
      nextButton.addEventListener("click", function() {
        if (currentNidana < nidanas.length - 1) {
          currentNidana++;
          scrollToNidana(currentNidana);
          updateNavButtons();
        }
      });
      
      // Previous button
      prevButton.addEventListener("click", function() {
        if (currentNidana > 0) {
          currentNidana--;
          scrollToNidana(currentNidana);
          updateNavButtons();
        }
      });
      
      function updateNavButtons() {
        prevButton.disabled = currentNidana === 0;
        nextButton.disabled = currentNidana === nidanas.length - 1;
        
        // Update text for last nidana
        if (currentNidana === nidanas.length - 1) {
          nextButton.textContent = "End of Chain";
        } else {
          nextButton.textContent = "Next Nidāna";
        }
      }
    }
    
    function scrollToNidana(index) {
      const nidanaElement = document.getElementById(`nidana-${index + 1}`);
      const contentArea = document.getElementById("contentArea");
      
      if (nidanaElement) {
        // Scroll to the element
        contentArea.scrollTo({
          top: nidanaElement.offsetTop - 100,
          behavior: "smooth"
        });
        
        // Highlight on wheel
        highlightNidana(index);
        
        // Open the card if closed
        const card = nidanaElement.querySelector(".nidana-card");
        if (!card.classList.contains("expanded")) {
          toggleNidanaContent(card, nidanas[index]);
        }
        
        // Add highlight effect
        nidanaElement.style.transform = "scale(1.03)";
        nidanaElement.style.transition = "transform 0.5s var(--transition-bounce)";
        
        setTimeout(() => {
          nidanaElement.style.transform = "";
        }, 800);
      }
    }
    
    // ===== PINNABLE TOOLTIPS =====
    function createPinnableTooltip(element, title, content) {
      // Check if there's already a pinned tooltip
      if (document.querySelector(".pin-tooltip.pinned")) {
        return;
      }
      
      // Remove any existing tooltips
      const existingTooltips = document.querySelectorAll(".pin-tooltip:not(.pinned)");
      existingTooltips.forEach(tooltip => tooltip.remove());
      
      // Create tooltip
      const tooltip = document.createElement("div");
      tooltip.classList.add("pin-tooltip");
      
      // Add pin button
      const pinButton = document.createElement("button");
      pinButton.classList.add("pin-button");
      pinButton.innerHTML = "📌";
      pinButton.title = "Pin this tooltip";
      
      // Add content
      const tooltipTitle = document.createElement("h4");
      tooltipTitle.classList.add("pin-tooltip-title");
      tooltipTitle.textContent = title;
      
      const tooltipContent = document.createElement("div");
      tooltipContent.classList.add("pin-tooltip-content");
      tooltipContent.textContent = content;
      
      tooltip.appendChild(pinButton);
      tooltip.appendChild(tooltipTitle);
      tooltip.appendChild(tooltipContent);
      
      // Position the tooltip
      const rect = element.getBoundingClientRect();
      tooltip.style.left = (rect.left + rect.width / 2) + "px";
      tooltip.style.top = rect.top + "px";
      
      // Add tooltip to the DOM
      document.body.appendChild(tooltip);
      
      // Show the tooltip
      setTimeout(() => {
        tooltip.classList.add("visible");
      }, 10);
      
      // Pin/unpin functionality
      pinButton.addEventListener("click", function(event) {
        event.stopPropagation();
        tooltip.classList.toggle("pinned");
        pinButton.innerHTML = tooltip.classList.contains("pinned") ? "❌" : "📌";
        pinButton.title = tooltip.classList.contains("pinned") ? "Unpin" : "Pin this tooltip";
      });
      
      // Close tooltip when clicking outside
      document.addEventListener("click", function(event) {
        if (!tooltip.classList.contains("pinned") && 
            !tooltip.contains(event.target) && 
            event.target !== element) {
          tooltip.classList.remove("visible");
          setTimeout(() => {
            tooltip.remove();
          }, 300);
        }
      });
      
      return tooltip;
    }
  </script>
</body>
</html>
